# AVQON Monitor MVP 0.1 — резюме и готовность

## Что есть

### Архитектура (по ТЗ)
- **Telegram-бот** — единственный интерфейс пользователя.
- **Data Fetcher** — сбор постов с каналов (Telethon).
- **Analysis Worker** — pHash для картинок, сравнение текста, запись совпадений.
- **PostgreSQL** — одна БД, схема из 5 таблиц.
- **Планировщик** (APScheduler) — запуск fetcher и worker по расписанию + рассылка уведомлений.

### Реализованные компоненты

| Компонент | Статус | Описание |
|-----------|--------|----------|
| **Конфигурация** | ✅ | `config.py`, `.env.example`, переменные окружения |
| **БД** | ✅ | Схема PostgreSQL (users, channels, raw_posts, content_hashes, matches), `database.py`, `models.py` |
| **Бот** | ✅ | `/start`, `/connect @channel` (проверка прав админа), `/stats`, обработчики в `bot/handlers.py` |
| **Data Fetcher** | ✅ | Подключение каналов из БД, итерация по сообщениям (Telethon), запись в `raw_posts` с задержками API |
| **Analysis Worker** | ✅ | Вычисление pHash (imagehash), нормализация текста, SequenceMatcher, запись в `content_hashes` и `matches`; сравнение только с постами защищённых каналов |
| **Notifier** | ✅ | Выбор ненаправленных `matches`, отправка сообщений владельцу канала (оригинал/копия) |
| **Scheduler** | ✅ | Fetcher и worker по интервалу (например 30 мин), notifier каждые 5 мин |
| **Точки входа** | ✅ | `run_bot.py`, `run_fetcher.py`, `run_worker.py`, `run_notifier.py`, `run_scheduler.py` |
| **Зависимости** | ✅ | `requirements.txt`: python-telegram-bot, telethon, imagehash, Pillow, apscheduler, psycopg2-binary |
| **Документация** | ✅ | README с установкой, конфигом, первым запуском, структурой проекта |

### Что не входит в текущий MVP (по ТЗ или сознательно отложено)
- **Платежи** (ЮKassa/CloudPayments) — в ТЗ были для «управления подпиской»; в коде только поля `subscription_status`/`tariff` в `users`, логики оплаты нет.
- **Отдельный список «целевых» каналов для мониторинга** — сейчас мониторятся только каналы, подключённые через `/connect` (и с них же идёт сбор).
- **Ручная модерация** («Это копия» / «Это не копия») — в ТЗ упоминалась для обучения; не реализована.
- **Интеграционные/автотесты** — нет.

---

## Готовность MVP 0.1

**Оценка: ~85–90% готов к проверке гипотезы.**

- **Готово к запуску:** развёртывание бота, БД (PostgreSQL), сбор постов, анализ (pHash + текст), создание совпадений, уведомления и планировщик. Этого достаточно, чтобы подключить канал, накопить посты и получать уведомления о возможных копиях.
- **Остаётся перед «полным» MVP 0.1 по ТЗ:**
  1. **Один раз пройти сценарий руками:** создать бота, БД, авторизовать Telethon, подключить канал, запустить fetcher/worker и убедиться в уведомлениях (при наличии копий).
  2. **По желанию:** базовая интеграция оплаты (хотя бы заглушка «подписка активна» после оплаты) и/или явный список целевых каналов для мониторинга — если это в приоритете по продукту.

Итого: каркас и основной сценарий «подключил канал → собираем посты → ищем копии → уведомляем» реализованы; MVP 0.1 готов к тестовому запуску и итерациям после него.
